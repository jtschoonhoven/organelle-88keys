#N canvas 169 244 1343 679 12;
#X obj 316 137 inlet;
#X msg 316 217 88;
#X obj 316 257 until;
#X obj 316 297 float;
#X msg 385 254 21;
#X obj 385 294 + 1;
#X text 385 136 <-- receives the name of an instrument folder;
#X text 385 216 <-- iterate once for each piano key;
#X text 429 293 <-- iterate all 88 midi notes \, 21-108;
#X obj 316 377 mod 12;
#X obj 316 417 select 0 1 2 3 4 5 6 7 8 9 10 11;
#X msg 538 474 A;
#X msg 609 474 B;
#X msg 243 473 C;
#X msg 377 473 E;
#X msg 408 473 F;
#X msg 471 473 G;
#X msg 344 473 Eb;
#X msg 574 474 Bb;
#X msg 276 473 Db;
#X msg 309 473 D;
#X msg 440 473 Gb;
#X msg 504 473 Ab;
#X text 386 376 <-- mod 12 so that 0=C \, 1=C# \, etc;
#X text 558 415 <-- get all possible note names;
#X obj 795 377 / 12;
#X obj 795 475 int;
#X obj 795 417 - 1;
#X text 843 376 <-- divide by 12 to get the octave number;
#X obj 896 297 makefilename instruments/%s/%%s.wav;
#X msg 900 561 set \$1;
#X obj 900 601 makefilename;
#X obj 428 541 pack s f;
#X msg 428 581 symbol \$1\$2;
#X text 510 540 <-- combine note and octave to get all notes A0-C8;
#X obj 898 670 file_exists;
#X text 429 256 <-- initialize counter to 21 \, the first note (A0);
#X obj 867 739 spigot;
#X obj 135 736 spigot;
#X obj 316 337 t f f f f;
#X floatatom 102 377 5 0 0 0 - - - 0;
#X text 995 600 <-- here we have the relative path to a wav file;
#X text 1065 173 <-- map midi notes to wav files;
#X obj 514 787 pack f s;
#X obj 102 416 t f f;
#X obj 101 817 select 108;
#X text 188 816 <-- selecting 108 runs at end of loop;
#X obj 101 897 outlet;
#X text 167 896 <-- return the note_to_wav map as a list;
#X text 996 669 <-- file_exists returns 1 if the file exists \, else 0;
#X obj 896 177 text define _note_to_wav;
#X obj 514 827 text insert _note_to_wav;
#X obj 101 857 text tolist _note_to_wav;
#X obj 896 257 text delete _note_to_wav;
#X obj 316 177 t b b b b s;
#X msg 896 217 -1;
#X text 1090 256 <-- ensure mapping is empty at start;
#X text 86 40 This subpatch receives the name of an instrument folder and returns a list of (midi_note_int \, path_to_sample.wav).;
#X obj 898 706 t f f;
#X obj 867 636 t s s;
#X connect 0 0 54 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 39 0;
#X connect 4 0 3 1;
#X connect 5 0 3 1;
#X connect 9 0 10 0;
#X connect 10 0 13 0;
#X connect 10 1 19 0;
#X connect 10 2 20 0;
#X connect 10 3 17 0;
#X connect 10 4 14 0;
#X connect 10 5 15 0;
#X connect 10 6 21 0;
#X connect 10 7 16 0;
#X connect 10 8 22 0;
#X connect 10 9 11 0;
#X connect 10 10 18 0;
#X connect 10 11 12 0;
#X connect 11 0 32 0;
#X connect 12 0 32 0;
#X connect 13 0 32 0;
#X connect 14 0 32 0;
#X connect 15 0 32 0;
#X connect 16 0 32 0;
#X connect 17 0 32 0;
#X connect 18 0 32 0;
#X connect 19 0 32 0;
#X connect 20 0 32 0;
#X connect 21 0 32 0;
#X connect 22 0 32 0;
#X connect 25 0 27 0;
#X connect 26 0 32 1;
#X connect 27 0 26 0;
#X connect 29 0 30 0;
#X connect 30 0 31 0;
#X connect 31 0 59 0;
#X connect 32 0 33 0;
#X connect 33 0 31 0;
#X connect 35 0 58 0;
#X connect 37 0 43 1;
#X connect 38 0 43 0;
#X connect 39 0 40 0;
#X connect 39 1 9 0;
#X connect 39 2 25 0;
#X connect 39 3 5 0;
#X connect 40 0 44 0;
#X connect 43 0 51 0;
#X connect 44 0 45 0;
#X connect 44 1 38 0;
#X connect 45 0 52 0;
#X connect 52 0 47 0;
#X connect 54 0 1 0;
#X connect 54 1 4 0;
#X connect 54 2 55 0;
#X connect 54 3 50 0;
#X connect 54 4 29 0;
#X connect 55 0 53 0;
#X connect 58 0 38 1;
#X connect 58 1 37 1;
#X connect 59 0 37 0;
#X connect 59 1 35 0;
