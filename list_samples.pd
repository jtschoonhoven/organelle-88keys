#N canvas 1003 0 2005 1664 12;
#X obj 317 96 inlet;
#X msg 318 293 88;
#X obj 318 333 until;
#X obj 318 373 float;
#X msg 387 330 21;
#X obj 387 370 + 1;
#X text 386 95 <-- receives the name of an instrument folder;
#X text 387 292 <-- iterate once for each piano key;
#X text 431 369 <-- iterate all 88 midi notes \, 21-108;
#X obj 318 453 mod 12;
#X obj 318 493 select 0 1 2 3 4 5 6 7 8 9 10 11;
#X text 388 452 <-- mod 12 so that 0=C \, 1=C# \, etc;
#X text 560 491 <-- get all possible note names;
#X obj 905 479 / 12;
#X obj 905 550 int;
#X obj 905 519 - 1;
#X text 973 453 <-- divide by 12 to get the octave number;
#X text 676 618 <-- combine note and octave to get all notes A0-C8;
#X text 431 332 <-- initialize counter to 21 \, the first note (A0);
#X floatatom -28 456 5 0 0 0 - - - 0;
#X text 1126 176 <-- map midi notes to wav files;
#X obj -26 1348 select 108;
#X text 61 1347 <-- selecting 108 runs at end of loop;
#X obj -26 1428 outlet;
#X text 40 1427 <-- return the note_to_wav map as a list;
#X obj 362 1294 text insert _note_to_wav;
#X obj -26 1388 text tolist _note_to_wav;
#X obj 1024 326 text delete _note_to_wav;
#X msg 1008 297 -1;
#X text 86 40 This subpatch receives the name of an instrument folder and returns a list of (midi_note_int \, path_to_sample.wav).;
#X obj 1122 579 folder_list;
#X msg 1121 549 symbol instruments/\$1/*;
#X obj 1123 607 split_path;
#X text 1115 207 <-- list of wav files for instrument like C3.wav;
#X obj 1009 352 text delete _wav_files;
#X text 1208 326 <-- ensure lists are empty at start;
#X obj 924 175 text define -k _note_to_wav;
#A set 84 f instruments/rhodes/C6f.wav \; 84 m instruments/rhodes/C6.wav \; 82 p instruments/rhodes/Bb5p.wav \; 79 p instruments/rhodes/G5p.wav \; 79 m instruments/rhodes/G5.wav \; 75 f instruments/rhodes/Eb5f.wav \; 72 f instruments/rhodes/C5f.wav \; 72 p instruments/rhodes/C5p.wav \; 72 m instruments/rhodes/C5.wav \; 67 f instruments/rhodes/G4f.wav \; 65 p instruments/rhodes/F4p.wav \; 65 m instruments/rhodes/F4.wav \; 63 f instruments/rhodes/Eb4f.wav \; 63 m instruments/rhodes/Eb4.wav \; 60 f instruments/rhodes/C4f.wav \; 58 p instruments/rhodes/Bb3p.wav \; 58 m instruments/rhodes/Bb3.wav \; 51 f instruments/rhodes/Eb3f.wav \; 51 p instruments/rhodes/Eb3p.wav \; 51 m instruments/rhodes/Eb3.wav \; 48 f instruments/rhodes/C3f.wav \; 48 p instruments/rhodes/C3p.wav \; 48 m instruments/rhodes/C3.wav \; 43 f instruments/rhodes/G2f.wav \; 43 p instruments/rhodes/G2p.wav \; 43 m instruments/rhodes/G2.wav \; 39 f instruments/rhodes/Eb2f.wav \; 36 p instruments/rhodes/C2p.wav \; 36 m instruments/rhodes/C2.wav \; 31 f instruments/rhodes/G1f.wav \; 31 p instruments/rhodes/G1p.wav \; 31 m instruments/rhodes/G1.wav \; 27 p instruments/rhodes/Eb1p.wav \; 24 p instruments/rhodes/C1p.wav \; 24 m instruments/rhodes/C1.wav \; 22 f instruments/rhodes/Bb0f.wav \;;
#X obj 925 206 text define -k _wav_files;
#A set G5p.wav \; G5.wav \; G4f.wav \; G2p.wav \; G2f.wav \; G2.wav \; G1p.wav \; G1f.wav \; G1.wav \; G0f.wav \; G0.wav \; F4p.wav \; F4.wav \; Eb5f.wav \; Eb4f.wav \; Eb4.wav \; Eb3p.wav \; Eb3f.wav \; Eb3.wav \; Eb2f.wav \; Eb1p.wav \; C6f.wav \; C6.wav \; C5p.wav \; C5f.wav \; C5.wav \; C4f.wav \; C3p.wav \; C3f.wav \; C3.wav \; C2p.wav \; C2.wav \; C1p.wav \; C1.wav \; Bb5p.wav \; Bb3p.wav \; Bb3.wav \; Bb0f.wav \;;
#X obj 1123 637 text insert _wav_files;
#X obj 184 1077 text search _wav_files;
#X obj 184 1108 select -1;
#X obj 317 136 t b b s s b b, f 67;
#X obj 736 1105 pack s s;
#X msg 736 1138 symbol instruments/\$2/\$1;
#X obj 318 413 t f f f f f;
#X floatatom 26 458 5 0 0 0 - - - 0;
#X obj -5 1190 float;
#X obj 244 1138 bang;
#X msg 172 104 symbol Rhodes;
#X obj 436 658 symbol p;
#X obj 510 659 symbol m;
#X obj 360 659 symbol f;
#X obj 590 659 symbol;
#X msg 586 990 symbol \$1\$2\$3.wav;
#X obj 586 959 pack s f s;
#X obj 586 1023 t s s s;
#X obj 587 879 t b s s;
#X obj 586 921 symbol, f 8;
#X obj 430 617 t b b b b a, f 31;
#X msg 641 817 symbol \$1;
#X msg 36 551 symbol C;
#X msg 102 551 symbol Db;
#X msg 805 549 symbol B;
#X msg 727 550 symbol Bb;
#X msg 658 551 symbol A;
#X msg 582 551 symbol Ab;
#X msg 516 550 symbol G;
#X msg 443 550 symbol Gb;
#X msg 175 551 symbol D;
#X msg 241 551 symbol Eb;
#X msg 314 551 symbol E;
#X msg 379 550 symbol F;
#X obj 360 686 t s s;
#X obj 436 687 t s s;
#X obj 510 687 t s s;
#X obj 590 686 t s s;
#X text 653 919 <-- 2 store note name;
#X text 717 989 <-- 3 build filename;
#X text 921 1140 <-- 4 pack path to wav;
#X text 351 1079 <-- 5 check if wav exists;
#X text 41 1192 <-- 6 wav exists: update _note_to_wav;
#X text 267 812 1 set p/m/f -->;
#X obj 361 1254 pack f f s;
#X obj 392 813 float;
#X msg 622 714 3;
#X msg 542 716 3;
#X msg 468 716 1;
#X msg 391 716 4;
#X text 173 717 forte=4 \; mezzo=3 \; piano=1 -->;
#X connect 0 0 41 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 44 0;
#X connect 4 0 3 1;
#X connect 5 0 3 1;
#X connect 9 0 10 0;
#X connect 10 0 60 0;
#X connect 10 1 61 0;
#X connect 10 2 68 0;
#X connect 10 3 69 0;
#X connect 10 4 70 0;
#X connect 10 5 71 0;
#X connect 10 6 67 0;
#X connect 10 7 66 0;
#X connect 10 8 65 0;
#X connect 10 9 64 0;
#X connect 10 10 63 0;
#X connect 10 11 62 0;
#X connect 13 0 15 0;
#X connect 14 0 54 1;
#X connect 15 0 14 0;
#X connect 19 0 21 0;
#X connect 21 0 26 0;
#X connect 26 0 23 0;
#X connect 28 0 27 0;
#X connect 28 0 34 0;
#X connect 30 0 32 0;
#X connect 31 0 30 0;
#X connect 32 0 38 0;
#X connect 39 0 40 0;
#X connect 40 1 47 0;
#X connect 41 0 1 0;
#X connect 41 1 4 0;
#X connect 41 2 42 1;
#X connect 41 3 31 0;
#X connect 41 4 28 0;
#X connect 41 5 36 0;
#X connect 41 5 37 0;
#X connect 42 0 43 0;
#X connect 43 0 82 2;
#X connect 44 0 19 0;
#X connect 44 1 9 0;
#X connect 44 2 45 0;
#X connect 44 3 13 0;
#X connect 44 4 5 0;
#X connect 45 0 46 1;
#X connect 46 0 82 0;
#X connect 47 0 46 0;
#X connect 48 0 41 0;
#X connect 49 0 73 0;
#X connect 50 0 74 0;
#X connect 51 0 72 0;
#X connect 52 0 75 0;
#X connect 53 0 55 0;
#X connect 54 0 53 0;
#X connect 55 0 39 0;
#X connect 55 2 42 0;
#X connect 56 0 57 0;
#X connect 56 1 54 2;
#X connect 57 0 54 0;
#X connect 58 0 51 0;
#X connect 58 1 49 0;
#X connect 58 2 50 0;
#X connect 58 3 52 0;
#X connect 58 4 59 0;
#X connect 59 0 57 1;
#X connect 60 0 58 0;
#X connect 61 0 58 0;
#X connect 62 0 58 0;
#X connect 63 0 58 0;
#X connect 64 0 58 0;
#X connect 65 0 58 0;
#X connect 66 0 58 0;
#X connect 67 0 58 0;
#X connect 68 0 58 0;
#X connect 69 0 58 0;
#X connect 70 0 58 0;
#X connect 71 0 58 0;
#X connect 72 0 56 0;
#X connect 72 1 87 0;
#X connect 73 0 56 0;
#X connect 73 1 86 0;
#X connect 74 0 56 0;
#X connect 74 1 85 0;
#X connect 75 0 56 0;
#X connect 75 1 84 0;
#X connect 82 0 25 0;
#X connect 83 0 82 1;
#X connect 84 0 83 0;
#X connect 85 0 83 0;
#X connect 86 0 83 0;
#X connect 87 0 83 0;
