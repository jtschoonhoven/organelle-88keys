#N canvas 0 0 1680 1022 12;
#X obj 609 127 list_samples;
#X obj 809 127 text define note_to_wav;
#X obj 838 228 text delete note_to_wav;
#X msg 809 197 -1;
#X obj 572 49 inlet;
#N canvas 92 130 556 433 arrays 0;
#X obj 10 0 table array-107-4;
#X obj 10 20 table array-107-1;
#X obj 10 40 table array-107-3;
#X obj 10 60 table array-101-4;
#X obj 10 80 table array-101-1;
#X obj 10 100 table array-101-3;
#X obj 10 120 table array-95-4;
#X obj 10 140 table array-95-1;
#X obj 10 160 table array-95-3;
#X obj 10 180 table array-89-4;
#X obj 10 200 table array-89-1;
#X obj 10 220 table array-89-3;
#X obj 10 240 table array-83-4;
#X obj 10 260 table array-83-1;
#X obj 10 280 table array-83-3;
#X obj 10 300 table array-77-4;
#X obj 10 320 table array-77-1;
#X obj 10 340 table array-77-3;
#X obj 10 360 table array-71-4;
#X obj 10 380 table array-71-1;
#X obj 10 400 table array-71-3;
#X obj 10 420 table array-65-4;
#X obj 10 440 table array-65-1;
#X obj 10 460 table array-65-3;
#X obj 10 480 table array-59-4;
#X obj 10 500 table array-59-1;
#X obj 10 520 table array-59-3;
#X obj 10 540 table array-53-4;
#X obj 10 560 table array-53-1;
#X obj 10 580 table array-53-3;
#X obj 10 600 table array-47-4;
#X obj 10 620 table array-47-1;
#X obj 10 640 table array-47-3;
#X obj 10 660 table array-41-4;
#X obj 10 680 table array-41-1;
#X obj 10 700 table array-41-3;
#X obj 10 720 table array-35-4;
#X obj 10 740 table array-35-1;
#X obj 10 760 table array-35-3;
#X obj 10 780 table array-29-4;
#X obj 10 800 table array-29-1;
#X obj 10 820 table array-29-3;
#X obj 10 840 table array-23-4;
#X obj 10 860 table array-23-1;
#X obj 10 880 table array-23-3;
#X restore 734 736 pd arrays;
#X obj 590 391 until;
#X msg 590 461 step;
#X msg 762 356 line 0;
#X obj 788 457 float;
#X floatatom 819 317 5 0 0 0 - - - 0;
#X obj 590 426 t b b;
#X obj 857 457 + 1;
#X obj 788 492 t f f;
#X obj 622 736 s pd-arrays;
#X obj 788 527 * 20;
#X msg 463 457 clear;
#X obj 590 293 t b b b b;
#X text 317 456 reset subpatch -->;
#X text 871 316 <-- init counter value;
#X text 897 456 <-- increment counter each sample;
#X text 323 355 iterate for each sample in file -->;
#X text 830 530 <-- y-offset of new object in subpatch;
#X text 836 700 <-- dynamically add table to subpatch;
#X obj 590 531 t l l;
#X obj 592 814 soundfiler;
#X floatatom 592 849 5 0 0 0 - - - 0;
#X text 396 162 populate note_to_wav list -->;
#X text 639 852 <-- number of samples in this wav file;
#X text 836 732 <-- click to view subpatch;
#X text 994 126 <-- ensure text lists exist;
#X text 1029 227 <-- ensure text lists begin empty;
#X text 430 569 midi_note \, path_to_wav -->;
#X text 451 668 midi_note \, y-offset -->;
#X text 317 488 read lines: midi_note \, path_to_wav -->;
#X obj 622 666 pack s f;
#X msg 622 701 obj 10 \$2 table \$1;
#X text 494 631 name of array -->;
#X msg 156 847 88;
#X obj 156 882 until;
#X obj 156 917 float;
#X msg 225 882 21;
#X text 204 846 <-- iterate once for each piano key;
#X text 268 957 <-- iterate all 88 midi notes \, 21-108;
#X text 272 881 <-- initialize counter to 21 \, the first note (A0);
#X obj 572 84 t b b s b b;
#X obj 156 812 t b b;
#X obj 809 162 text define _note_to_array;
#X obj 809 255 text delete _note_to_array;
#X obj 590 496 text sequence note_to_wav;
#X obj 590 356 text size note_to_wav;
#X obj 609 162 text fromlist note_to_wav;
#X text 38 33 This subpatch receives an instrument name and returns a list of: (midi_note \, array_name \, note_offset \, num_samples), f 65;
#X msg 638 49 symbol rhodes;
#X obj 230 957 + 1;
#X obj 179 994 t b b b f, f 13;
#X obj 208 1090 float, f 9;
#X msg 179 1024 1, f 2;
#X msg 208 1024 3, f 2;
#X msg 237 1024 4, f 2;
#X obj 208 1056 t b f;
#X obj 208 1122 pack f f;
#X obj 210 1488 text insert _note_to_array;
#X text 402 1488 <-- note_to_array is a list of: midi_note \, strength (1 \, 3 \, 4) \, array_name \, note_offset \, num_samples, f 101;
#X obj 210 1449 pack f f s f f, f 17;
#X text 276 1120 <-- tuple of midi_note \, strength (1 \, 3 \, 4);
#X text 277 1023 <-- permute midi note with strength (1 \, 3 \, 4);
#X obj 156 956 t f f f;
#X obj 208 1155 text search note_to_wav near 0 near 1;
#X obj 208 1190 text get note_to_wav;
#X obj 240 1252 unpack f f s;
#X text 478 1154 <-- get the closest sample for this midi note and velocity;
#X text 344 1253 <-- extract the matching midi note and strength (wav path is ignored), f 72;
#X obj 48 1341 float;
#X msg 279 1346 symbol array-\$1-\$2;
#X obj 279 1318 pack f f;
#X obj 208 1220 t b l;
#X obj 126 1361 -, f 8;
#X obj 126 1330 float;
#X obj 126 1298 t b f, f 8;
#X obj 327 1411 array size;
#X obj 59 1559 select 108;
#X text 146 1558 <-- selecting 108 runs at end of loop;
#X obj 59 1639 outlet;
#X obj 59 1599 text tolist _note_to_array;
#X text 125 1638 <-- return the _note_to_list map as a list;
#X obj 327 1378 t b s;
#X obj 622 570 unpack f f s;
#X msg 622 631 array-\$1-\$2;
#X obj 622 600 pack f f;
#X msg 592 779 read -resize \$3 array-\$1-\$2;
#X text 1592 965 <-- get the closest sample for this midi note;
#X obj 1382 1233 array size;
#X obj 1359 1199 t s b s;
#X obj 1265 1229 -;
#X obj 1177 1305 text insert _note_to_array;
#X obj 1148 798 t f f f f f, f 17;
#X obj 1147 1356 select 108;
#X text 1234 1355 <-- selecting 108 runs at end of loop;
#X obj 1147 1436 outlet;
#X obj 1147 1396 text tolist _note_to_array;
#X text 1213 1435 <-- return the _note_to_list map as a list;
#X obj 1326 965 text search note_to_wav near 0 near 1;
#X msg 1368 844 1, f 2;
#X msg 1397 844 3, f 2;
#X msg 1426 845 4, f 2;
#X text 1369 1305 <-- note_to_array is a list of: midi_note \, strength (1 \, 3 \, 4) \, array_name \, note_offset \, num_samples, f 101;
#X obj 1398 933 pack f f, f 9;
#X text 1486 1000 <-- extract the matching midi note and strength;
#X obj 1326 1000 text get note_to_wav;
#X obj 1326 1030 unpack f f s;
#X obj 1177 1266 pack f f s f f, f 17;
#X obj 1177 1229 float;
#X obj 1265 1195 float;
#X obj 1244 1067 t b b f f;
#X msg 1359 1164 symbol array-\$1-\$2;
#X obj 1359 1136 pack f f;
#X obj 1398 905 float, f 9;
#X obj 1368 814 t b b b f, f 13;
#X obj 1397 877 t b f, f 7;
#X obj 643 1078 float;
#X text 1133 24 Copyright (c) 2025 Jonathan Schoonhoven All rights reserved. Redistribution and use of this file \, in source or binary form \, without explicit permission from the copyright holder is prohibited., f 73;
#X connect 0 0 51 0;
#X connect 3 0 2 0;
#X connect 3 0 48 0;
#X connect 4 0 45 0;
#X connect 6 0 11 0;
#X connect 7 0 49 0;
#X connect 8 0 49 0;
#X connect 9 0 13 0;
#X connect 10 0 9 1;
#X connect 11 0 7 0;
#X connect 11 1 9 0;
#X connect 12 0 9 1;
#X connect 13 0 15 0;
#X connect 13 1 12 0;
#X connect 15 0 35 1;
#X connect 16 0 14 0;
#X connect 17 0 50 0;
#X connect 17 1 8 0;
#X connect 17 2 10 0;
#X connect 17 3 16 0;
#X connect 24 0 90 0;
#X connect 24 1 87 0;
#X connect 25 0 26 0;
#X connect 35 0 36 0;
#X connect 36 0 14 0;
#X connect 38 0 39 0;
#X connect 39 0 40 0;
#X connect 40 0 67 0;
#X connect 41 0 40 1;
#X connect 45 0 46 0;
#X connect 45 1 17 0;
#X connect 45 2 0 0;
#X connect 45 3 3 0;
#X connect 45 4 1 0;
#X connect 45 4 47 0;
#X connect 46 0 38 0;
#X connect 46 1 41 0;
#X connect 49 0 24 0;
#X connect 50 0 6 0;
#X connect 53 0 45 0;
#X connect 54 0 40 1;
#X connect 55 0 57 0;
#X connect 55 1 58 0;
#X connect 55 2 59 0;
#X connect 55 3 56 1;
#X connect 56 0 61 0;
#X connect 56 0 78 1;
#X connect 56 0 73 1;
#X connect 57 0 60 0;
#X connect 58 0 60 0;
#X connect 59 0 60 0;
#X connect 60 0 56 0;
#X connect 60 1 61 1;
#X connect 60 1 120 0;
#X connect 61 0 68 0;
#X connect 64 0 62 0;
#X connect 67 0 81 0;
#X connect 67 1 55 0;
#X connect 67 2 54 0;
#X connect 68 0 69 0;
#X connect 69 0 76 0;
#X connect 70 0 75 0;
#X connect 70 0 79 0;
#X connect 70 1 75 1;
#X connect 73 0 64 0;
#X connect 74 0 64 2;
#X connect 74 0 86 0;
#X connect 75 0 74 0;
#X connect 76 0 73 0;
#X connect 76 1 70 0;
#X connect 77 0 64 3;
#X connect 78 0 77 0;
#X connect 79 0 78 0;
#X connect 79 1 77 1;
#X connect 80 0 64 4;
#X connect 81 0 84 0;
#X connect 84 0 83 0;
#X connect 86 0 80 0;
#X connect 86 1 80 1;
#X connect 87 0 89 0;
#X connect 87 1 89 1;
#X connect 88 0 35 0;
#X connect 89 0 88 0;
#X connect 90 0 25 0;
#X connect 92 0 111 4;
#X connect 93 0 111 2;
#X connect 93 1 92 0;
#X connect 93 2 92 1;
#X connect 94 0 111 3;
#X connect 96 0 97 0;
#X connect 96 1 118 0;
#X connect 96 2 112 1;
#X connect 96 3 113 1;
#X connect 97 0 100 0;
#X connect 100 0 99 0;
#X connect 102 0 109 0;
#X connect 103 0 119 0;
#X connect 104 0 119 0;
#X connect 105 0 119 0;
#X connect 107 0 102 0;
#X connect 109 0 110 0;
#X connect 110 0 114 0;
#X connect 110 1 111 1;
#X connect 110 1 116 1;
#X connect 111 0 95 0;
#X connect 112 0 111 0;
#X connect 113 0 94 0;
#X connect 114 0 112 0;
#X connect 114 1 113 0;
#X connect 114 2 94 1;
#X connect 114 3 116 0;
#X connect 115 0 93 0;
#X connect 116 0 115 0;
#X connect 117 0 107 0;
#X connect 118 0 103 0;
#X connect 118 1 104 0;
#X connect 118 2 105 0;
#X connect 118 3 117 1;
#X connect 119 0 117 0;
#X connect 119 1 107 1;
#X connect 120 0 64 1;
